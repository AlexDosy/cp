import heapq

def totalCost(costs, k, candidates):
    n = len(costs)
    left = []   # min-heap from the left
    right = []  # min-heap from the right

    i = 0
    j = n - 1

    # Load first "candidates" workers from left
    for _ in range(min(candidates, n)):
        heapq.heappush(left, (costs[i], i))
        i += 1

    # Load last "candidates" workers from right
    for _ in range(min(candidates, n - (i))):
        heapq.heappush(right, (costs[j], j))
        j -= 1

    total = 0

    for _ in range(k):
        # Pick from empty/non-empty heaps correctly
        if not right or (left and left[0] <= right[0]):
            cost, idx = heapq.heappop(left)
            total += cost

            # Add next from left side if available
            if i <= j:
                heapq.heappush(left, (costs[i], i))
                i += 1
        else:
            cost, idx = heapq.heappop(right)
            total += cost

            # Add next from right side if available
            if i <= j:
                heapq.heappush(right, (costs[j], j))
                j -= 1

    return total
